Ext.require(["Ext.form.*"]);function DefineInterface_bp3ft_def_(a,b,j){var g;var h=false;var i=false;function d(m,l){var k=g.activeRecord,n=g.getForm();if(!k){return}if(n.isValid()){n.updateRecord(k);StatusDB("Сохранение данных");Ext.Ajax.request({url:rootURL+"index.php/c_bp3ft_def/setRow",method:"POST",params:{instanceid:g.instanceid,bp3ft_defid:k.get("bp3ft_defid"),typestyle:k.get("typestyle"),name:k.get("name"),gridsorttype:k.get("gridsorttype"),the_comment:k.get("the_comment"),allowsize:k.get("allowsize"),allowlikesearch:k.get("allowlikesearch"),maximum:k.get("maximum"),minimum:k.get("minimum"),delayedsave:k.get("delayedsave")},success:function(p){var q=p.responseText;var o=Ext.decode(q);if(o.success==false){Ext.MessageBox.show({title:"Ошибка",msg:o.msg,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR});StatusErr("Ошибка. "+o.msg);h=false}else{if(k.get("bp3ft_defid")==""){k.set("bp3ft_defid",o.data.bp3ft_defid)}StatusReady("Изменения сохранены");h=true;if(j){Ext.Ajax.request({url:rootURL+'index.php/c_v_autobp3ft_def/getRows?&filter=[{"property":"bp3ft_defid","value":"'+k.get("bp3ft_defid")+'"}]',method:"GET",success:function(s){var r=Ext.decode(s.responseText);j.set(r.rows[0]);j.commit()}})}if(m){if(typeof(l)=="function"){l()}g.up("window").close()}}}})}else{Ext.MessageBox.show({title:"Ошибка",msg:"Не все обязательные поля заполнены!",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR})}}function e(k){d(false,k)}function f(k){d(true,k)}function c(){g.setActiveRecord(null,null)}g=new Ext.form.Panel({itemId:a+"",autoScroll:true,border:0,bodyPadding:5,activeRecord:null,selection:j,defaultType:"textfield",doSave:f,canClose:function(){if(i){if(!g.getForm().isValid()){return true}return true}else{if(!g.getForm().isValid()){return false}if(h){return true}return false}},id:"bp3ft_def",fieldDefaults:{labelAlign:"right",labelWidth:110},items:[{xtype:"fieldset",anchor:"100%",x:0,layout:"absolute",id:"bp3ft_def_0",title:"Основные данные",defaultType:"textfield",items:[{minWidth:365,width:365,maxWidth:365,x:5,y:5,labelWidth:140,xtype:"combobox",editable:false,store:enum_TypeStyle,valueField:"name",displayField:"name",typeAhead:true,queryMode:"local",emptyText:"",name:"typestyle_grid",itemId:"typestyle_grid",listeners:{select:function(k,m,l){k.up("form").activeRecord.set("typestyle",m[0].get("value"))}},fieldLabel:"Трактовка",labelClsExtra:"x-item-mandatory",allowBlank:false},{minWidth:365,width:365,maxWidth:365,x:375,y:5,labelWidth:140,xtype:"textfield",value:"",name:"name",itemId:"name",fieldLabel:"Название",labelClsExtra:"x-item-mandatory",allowBlank:false},{minWidth:365,width:365,maxWidth:365,x:5,y:35,labelWidth:140,xtype:"combobox",editable:false,trigger1Cls:"x-form-clear-trigger",trigger2Cls:"x-form-select-trigger",hideTrigger1:false,hideTrigger2:false,onTrigger1Click:function(){this.collapse();this.clearValue()},onTrigger2Click:function(){if(this.isExpanded){this.collapse()}else{this.expand()}},store:enum_ColumnSortType,valueField:"name",displayField:"name",typeAhead:true,queryMode:"local",emptyText:"",name:"gridsorttype_grid",itemId:"gridsorttype_grid",listeners:{select:function(k,m,l){k.up("form").activeRecord.set("gridsorttype",m[0].get("value"))}},fieldLabel:"Вариант сортировки в табличном представлении",allowBlank:true},{minWidth:720,xtype:"textarea",x:5,y:65,height:80,labelWidth:140,xtype:"textarea",value:"",name:"the_comment",itemId:"the_comment",fieldLabel:"Описание",allowBlank:true}],height:190},{xtype:"fieldset",anchor:"100%",x:0,layout:"absolute",id:"bp3ft_def_1",title:"Дополнительно",defaultType:"textfield",items:[{minWidth:365,width:365,maxWidth:365,x:5,y:5,labelWidth:140,xtype:"combobox",editable:false,store:enum_Boolean,valueField:"name",displayField:"name",typeAhead:true,queryMode:"local",emptyText:"",name:"allowsize_grid",itemId:"allowsize_grid",listeners:{select:function(k,m,l){k.up("form").activeRecord.set("allowsize",m[0].get("value"))}},fieldLabel:"Нужен размер",labelClsExtra:"x-item-mandatory",allowBlank:false},{minWidth:365,width:365,maxWidth:365,x:375,y:5,labelWidth:140,xtype:"combobox",editable:false,trigger1Cls:"x-form-clear-trigger",trigger2Cls:"x-form-select-trigger",hideTrigger1:false,hideTrigger2:false,onTrigger1Click:function(){this.collapse();this.clearValue()},onTrigger2Click:function(){if(this.isExpanded){this.collapse()}else{this.expand()}},store:enum_Boolean,valueField:"name",displayField:"name",typeAhead:true,queryMode:"local",emptyText:"",name:"allowlikesearch_grid",itemId:"allowlikesearch_grid",listeners:{select:function(k,m,l){k.up("form").activeRecord.set("allowlikesearch",m[0].get("value"))}},fieldLabel:"Поиск текста",allowBlank:true},{minWidth:365,width:365,maxWidth:365,x:5,y:35,labelWidth:140,xtype:"textfield",value:"",name:"maximum",itemId:"maximum",fieldLabel:"Максимум",allowBlank:true},{minWidth:365,width:365,maxWidth:365,x:375,y:35,labelWidth:140,xtype:"textfield",value:"",name:"minimum",itemId:"minimum",fieldLabel:"Минимум",allowBlank:true},{minWidth:365,width:365,maxWidth:365,x:5,y:65,labelWidth:140,xtype:"combobox",editable:false,trigger1Cls:"x-form-clear-trigger",trigger2Cls:"x-form-select-trigger",hideTrigger1:false,hideTrigger2:false,onTrigger1Click:function(){this.collapse();this.clearValue()},onTrigger2Click:function(){if(this.isExpanded){this.collapse()}else{this.expand()}},store:enum_Boolean,valueField:"name",displayField:"name",typeAhead:true,queryMode:"local",emptyText:"",name:"delayedsave_grid",itemId:"delayedsave_grid",listeners:{select:function(k,m,l){k.up("form").activeRecord.set("delayedsave",m[0].get("value"))}},fieldLabel:"Отложенное сохранение",allowBlank:true}],height:130}],instanceid:"",setActiveRecord:function(l,k){g.activeRecord=l;g.instanceid=k;if(l){g.getForm().loadRecord(l);i=g.getForm().isValid()}else{g.getForm().reset()}}});return g}function DefineForms_bp3ft_def_(){Ext.define("Form_bp3ft_def",{extend:"Ext.form.Panel",alias:"widget.f_bp3ft_def",initComponent:function(){this.addEvents("create");Ext.apply(this,{activeRecord:null,defaultType:"textfield",id:"bp3ft_def",x:0,fieldDefaults:{labelAlign:"top"},items:[{xtype:"panel",id:"bp3ft_def-0",title:"Основные данные",defaultType:"textfield",closable:false,collapsible:true,titleCollapse:true,layout:"absolute",x:0,items:[{minWidth:220,width:220,maxWidth:220,x:5,y:0,xtype:"combobox",editable:false,store:enum_TypeStyle,valueField:"name",displayField:"name",typeAhead:true,queryMode:"local",emptyText:"",name:"typestyle_grid",itemId:"typestyle_grid",listeners:{select:function(a,c,b){a.up("form").activeRecord.set("typestyle",c[0].get("value"))}},fieldLabel:"Трактовка",labelClsExtra:"x-item-mandatory",allowBlank:false,labelWidth:120},{minWidth:220,width:220,maxWidth:220,x:255,y:0,xtype:"textfield",value:"",name:"name",itemId:"name",fieldLabel:"Название",labelClsExtra:"x-item-mandatory",allowBlank:false,labelWidth:120},{minWidth:220,width:220,maxWidth:220,x:505,y:0,xtype:"combobox",editable:false,trigger1Cls:"x-form-clear-trigger",trigger2Cls:"x-form-select-trigger",hideTrigger1:false,hideTrigger2:false,onTrigger1Click:function(){this.collapse();this.clearValue()},onTrigger2Click:function(){if(this.isExpanded){this.collapse()}else{this.expand()}},store:enum_ColumnSortType,valueField:"name",displayField:"name",typeAhead:true,queryMode:"local",emptyText:"",name:"gridsorttype_grid",itemId:"gridsorttype_grid",listeners:{select:function(a,c,b){a.up("form").activeRecord.set("gridsorttype",c[0].get("value"))}},fieldLabel:"Вариант сортировки в табличном представлении",allowBlank:true,labelWidth:120},{minWidth:740,maxWidth:740,width:740,xtype:"textarea",x:5,y:46,height:80,xtype:"textarea",value:"",name:"the_comment",itemId:"the_comment",fieldLabel:"Описание",allowBlank:true,labelWidth:120}],width:760,height:176},{xtype:"panel",id:"bp3ft_def-1",title:"Дополнительно",defaultType:"textfield",closable:false,collapsible:true,titleCollapse:true,layout:"absolute",x:0,items:[{minWidth:220,width:220,maxWidth:220,x:5,y:0,xtype:"combobox",editable:false,store:enum_Boolean,valueField:"name",displayField:"name",typeAhead:true,queryMode:"local",emptyText:"",name:"allowsize_grid",itemId:"allowsize_grid",listeners:{select:function(a,c,b){a.up("form").activeRecord.set("allowsize",c[0].get("value"))}},fieldLabel:"Нужен размер",labelClsExtra:"x-item-mandatory",allowBlank:false,labelWidth:120},{minWidth:220,width:220,maxWidth:220,x:255,y:0,xtype:"combobox",editable:false,trigger1Cls:"x-form-clear-trigger",trigger2Cls:"x-form-select-trigger",hideTrigger1:false,hideTrigger2:false,onTrigger1Click:function(){this.collapse();this.clearValue()},onTrigger2Click:function(){if(this.isExpanded){this.collapse()}else{this.expand()}},store:enum_Boolean,valueField:"name",displayField:"name",typeAhead:true,queryMode:"local",emptyText:"",name:"allowlikesearch_grid",itemId:"allowlikesearch_grid",listeners:{select:function(a,c,b){a.up("form").activeRecord.set("allowlikesearch",c[0].get("value"))}},fieldLabel:"Поиск текста",allowBlank:true,labelWidth:120},{minWidth:220,width:220,maxWidth:220,x:505,y:0,xtype:"textfield",value:"",name:"maximum",itemId:"maximum",fieldLabel:"Максимум",allowBlank:true,labelWidth:120},{minWidth:220,width:220,maxWidth:220,x:5,y:46,xtype:"textfield",value:"",name:"minimum",itemId:"minimum",fieldLabel:"Минимум",allowBlank:true,labelWidth:120},{minWidth:220,width:220,maxWidth:220,x:255,y:46,xtype:"combobox",editable:false,trigger1Cls:"x-form-clear-trigger",trigger2Cls:"x-form-select-trigger",hideTrigger1:false,hideTrigger2:false,onTrigger1Click:function(){this.collapse();this.clearValue()},onTrigger2Click:function(){if(this.isExpanded){this.collapse()}else{this.expand()}},store:enum_Boolean,valueField:"name",displayField:"name",typeAhead:true,queryMode:"local",emptyText:"",name:"delayedsave_grid",itemId:"delayedsave_grid",listeners:{select:function(a,c,b){a.up("form").activeRecord.set("delayedsave",c[0].get("value"))}},fieldLabel:"Отложенное сохранение",allowBlank:true,labelWidth:120}],width:760,height:132}],instanceid:"",dockedItems:[{xtype:"toolbar",dock:"bottom",ui:"footer",items:["->",{iconCls:"icon-accept",itemId:"save",text:"Сохранить",disabled:true,scope:this,handler:this.onSave}]}]});this.callParent()},setActiveRecord:function(b,a){this.activeRecord=b;this.instanceid=a;if(b){this.down("#save").enable();this.getForm().loadRecord(b)}else{this.down("#save").disable();this.getForm().reset()}},onSave:function(){var a=this.activeRecord,b=this.getForm();if(!a){return}if(b.isValid()){b.updateRecord(a);StatusDB("Сохранение данных");Ext.Ajax.request({url:rootURL+"index.php/c_bp3ft_def/setRow",method:"POST",params:{instanceid:this.instanceid,bp3ft_defid:a.get("bp3ft_defid"),typestyle:a.get("typestyle"),name:a.get("name"),gridsorttype:a.get("gridsorttype"),the_comment:a.get("the_comment"),allowsize:a.get("allowsize"),allowlikesearch:a.get("allowlikesearch"),maximum:a.get("maximum"),minimum:a.get("minimum"),delayedsave:a.get("delayedsave")},success:function(d){var e=d.responseText;var c=Ext.decode(e);if(c.success==false){Ext.MessageBox.show({title:"Ошибка",msg:c.msg,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR});StatusErr("Ошибка. "+c.msg)}else{if(a.get("bp3ft_defid")==""){a.set("bp3ft_defid",c.data.bp3ft_defid)}StatusReady("Изменения сохранены")}}})}else{Ext.MessageBox.show({title:"Ошибка",msg:"Не все обязательные поля заполнены!",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR})}},onReset:function(){if(this.activeRecord.get("bp3ft_defid")==""){this.activeRecord.store.reload()}this.setActiveRecord(null,null);this.ownerCt.close()}});Ext.define("EditWindow_bp3ft_def",{extend:"Ext.window.Window",maxHeight:418,maxWidth:900,autoScroll:true,minWidth:750,width:800,minHeight:388,height:388,constrainHeader:true,layout:"absolute",autoShow:true,modal:true,closable:false,closeAction:"destroy",iconCls:"icon-application_form",title:"Тип поля",items:[{xtype:"f_bp3ft_def"}]})};